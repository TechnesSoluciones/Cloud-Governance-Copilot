# =============================================================================
# MONITORING AND OBSERVABILITY CONFIGURATION
# =============================================================================
# This file documents all monitoring-related environment variables for the
# Cloud Governance Copilot API Gateway.
#
# Usage:
# 1. Copy relevant variables to your .env file
# 2. Set appropriate values for your environment
# 3. Restart the application to apply changes
#
# Note: All monitoring features gracefully degrade if not configured.
# The application will run fine with minimal monitoring in development.
# =============================================================================

# -----------------------------------------------------------------------------
# LOGGING CONFIGURATION
# -----------------------------------------------------------------------------

# Log Level
# Controls the verbosity of logs
# Options: error, warn, info, debug
# Default: info
# Recommendation:
#   - Development: debug
#   - Staging: info
#   - Production: info or warn
LOG_LEVEL=info

# Log Format
# Controls the output format of logs
# Options:
#   - json: Structured JSON logs (recommended for production)
#   - pretty: Human-readable colored logs (recommended for development)
# Default: pretty in development, json in production
LOG_FORMAT=json

# Log File Path
# Path where log files will be written (only in production)
# Default: ./logs/app.log
# Note: Directory must exist and be writable
LOG_FILE_PATH=./logs/app.log

# Service Name
# Identifier for this service in logs and metrics
# Default: api-gateway
# Useful in microservices architecture to distinguish services
SERVICE_NAME=api-gateway

# -----------------------------------------------------------------------------
# METRICS CONFIGURATION
# -----------------------------------------------------------------------------

# Enable Metrics Collection
# Set to false to disable all metrics collection
# Default: true
# Note: Metrics are lightweight and recommended for all environments
METRICS_ENABLED=true

# Metrics Port
# Port for the Prometheus metrics endpoint (if using separate server)
# Default: 9090
# Note: Current implementation uses main application port
METRICS_PORT=9090

# -----------------------------------------------------------------------------
# ERROR TRACKING CONFIGURATION
# -----------------------------------------------------------------------------
# Error tracking services help you monitor and debug production issues.
# Supported providers: sentry, datadog, none
# All are optional - the app works fine without error tracking.

# Enable Error Tracking
# Set to true to enable error tracking service integration
# Default: false
ERROR_TRACKING_ENABLED=false

# Error Tracking Provider
# Options: sentry, datadog, none
# Default: none
ERROR_TRACKING_PROVIDER=none

# Sentry Configuration (if using Sentry)
# Get your DSN from https://sentry.io/settings/projects/
SENTRY_DSN=

# Sentry Environment
# Helps separate errors by environment in Sentry UI
# Examples: development, staging, production
SENTRY_ENVIRONMENT=production

# Sentry Release
# Version identifier for release tracking
# Can be git commit hash, version number, etc.
# Automatically set from package.json version if not provided
SENTRY_RELEASE=

# DataDog Configuration (if using DataDog)
# Get your API key from https://app.datadoghq.com/account/settings
DATADOG_API_KEY=

# Error Tracking Sample Rate
# Percentage of errors to send (0.0 to 1.0)
# Default: 1.0 (100% of errors)
# Use lower values in high-traffic production to reduce costs
ERROR_TRACKING_SAMPLE_RATE=1.0

# Max Breadcrumbs
# Number of breadcrumbs to keep for debugging context
# Default: 100
# Breadcrumbs are user actions that led to an error
ERROR_TRACKING_MAX_BREADCRUMBS=100

# Attach Stack Trace
# Whether to attach stack traces to error reports
# Default: true
ERROR_TRACKING_ATTACH_STACKTRACE=true

# -----------------------------------------------------------------------------
# REQUEST TRACING CONFIGURATION
# -----------------------------------------------------------------------------

# Enable Request Tracing
# Generate unique request IDs for tracking requests across services
# Default: true
ENABLE_REQUEST_TRACING=true

# Slow Request Threshold (milliseconds)
# Requests taking longer than this will be logged as warnings
# Default: 2000 (2 seconds)
# Useful for identifying performance issues
SLOW_REQUEST_THRESHOLD_MS=2000

# Log Request Start
# Whether to log when a request starts (in addition to completion)
# Default: false
# Useful for debugging but can be noisy in production
LOG_REQUEST_START=false

# -----------------------------------------------------------------------------
# HEALTH CHECK CONFIGURATION
# -----------------------------------------------------------------------------

# Health check endpoints are always available and don't require configuration
# Available endpoints:
#   - GET /health           - Simple liveness check
#   - GET /health/ready     - Readiness check (verifies dependencies)
#   - GET /health/live      - Kubernetes liveness probe
#   - GET /metrics          - Prometheus metrics
#   - GET /health/dependencies - Detailed dependency status

# -----------------------------------------------------------------------------
# PRODUCTION MONITORING INTEGRATION
# -----------------------------------------------------------------------------

# Application Performance Monitoring (APM)
# For advanced monitoring, consider these integrations:

# New Relic
# NEW_RELIC_LICENSE_KEY=
# NEW_RELIC_APP_NAME=cloud-governance-copilot-api

# DataDog APM
# DD_TRACE_ENABLED=true
# DD_SERVICE=api-gateway
# DD_ENV=production
# DD_VERSION=1.0.0

# Prometheus
# If using Prometheus, scrape the /metrics endpoint
# Example prometheus.yml configuration:
# scrape_configs:
#   - job_name: 'api-gateway'
#     static_configs:
#       - targets: ['localhost:3000']
#     metrics_path: '/metrics'

# Grafana
# Use Prometheus as data source and import dashboards
# Recommended dashboards:
#   - Node.js Application Metrics
#   - Express.js Dashboard
#   - Custom business metrics

# -----------------------------------------------------------------------------
# CLOUD PROVIDER LOGGING
# -----------------------------------------------------------------------------

# AWS CloudWatch
# When running on AWS, logs can be automatically sent to CloudWatch
# Configure through AWS SDK or instance role

# Azure Monitor
# When running on Azure, use Azure Monitor integration
# APPLICATIONINSIGHTS_CONNECTION_STRING=

# GCP Cloud Logging
# When running on GCP, logs are automatically sent to Cloud Logging
# No additional configuration needed if using GCP logging agent

# -----------------------------------------------------------------------------
# DEVELOPMENT TIPS
# -----------------------------------------------------------------------------

# For local development, minimal configuration is needed:
# LOG_LEVEL=debug
# LOG_FORMAT=pretty
# ENABLE_REQUEST_TRACING=true
# METRICS_ENABLED=true

# For production, recommended configuration:
# LOG_LEVEL=info
# LOG_FORMAT=json
# LOG_FILE_PATH=/var/log/api-gateway/app.log
# METRICS_ENABLED=true
# ERROR_TRACKING_ENABLED=true
# ERROR_TRACKING_PROVIDER=sentry
# SENTRY_DSN=your-dsn-here
# SENTRY_ENVIRONMENT=production
# SLOW_REQUEST_THRESHOLD_MS=2000

# -----------------------------------------------------------------------------
# SECURITY NOTES
# -----------------------------------------------------------------------------

# 1. Never commit actual API keys or DSNs to version control
# 2. Use secret management services in production (AWS Secrets Manager,
#    Azure Key Vault, HashiCorp Vault, etc.)
# 3. Rotate API keys regularly
# 4. Use different credentials for each environment
# 5. Limit log verbosity in production to avoid logging sensitive data
# 6. Ensure log files have appropriate permissions (600 or 640)
# 7. Set up log rotation to prevent disk space issues

# -----------------------------------------------------------------------------
# TROUBLESHOOTING
# -----------------------------------------------------------------------------

# If logs are not appearing:
# - Check LOG_LEVEL setting (should be info or debug)
# - Verify LOG_FILE_PATH directory exists and is writable
# - Check console output for initialization errors

# If metrics endpoint returns errors:
# - Verify METRICS_ENABLED=true
# - Check /metrics endpoint is accessible
# - Review application logs for metrics service errors

# If error tracking is not working:
# - Verify ERROR_TRACKING_ENABLED=true
# - Check provider configuration (DSN, API key)
# - Review network connectivity to tracking service
# - Check application logs for error tracking initialization errors

# For performance issues:
# - Lower SLOW_REQUEST_THRESHOLD_MS to catch more slow requests
# - Increase LOG_LEVEL to debug temporarily
# - Review metrics at /metrics endpoint
# - Check /health/dependencies for slow dependency responses
