# ============================================================
# Hetzner Storage Box Configuration Example
# ============================================================
# Copy this file to .env.storagebox and fill in your values
# Then load with: source .env.storagebox
# ============================================================

# ============================================================
# Hetzner Storage Box Credentials
# ============================================================
# Get these from Hetzner Robot: https://robot.hetzner.com/storage

# Storage Box username (format: u123456)
export STORAGEBOX_USER="u123456"

# Storage Box hostname (format: u123456.your-storagebox.de)
export STORAGEBOX_HOST="u123456.your-storagebox.de"

# SSH port (Hetzner uses port 23, NOT 22)
export STORAGEBOX_PORT="23"

# Path to SSH private key for authentication
# Generate with: ssh-keygen -t rsa -b 4096 -f ~/.ssh/hetzner_storagebox_rsa
export STORAGEBOX_SSH_KEY="$HOME/.ssh/hetzner_storagebox_rsa"

# Remote directory path in Storage Box for backups
export STORAGEBOX_REMOTE_DIR="/backups/postgresql"

# ============================================================
# Backup Configuration
# ============================================================

# Local temporary directory for backups before upload
export LOCAL_BACKUP_DIR="/tmp/postgres-backups"

# How many days to keep backups (both local and remote)
# Recommended: 30 days for daily backups
export RETENTION_DAYS="30"

# Path to backup log file
export LOG_FILE="/var/log/hetzner-backup.log"

# ============================================================
# Database Configuration
# ============================================================
# Override these if different from main .env file

# PostgreSQL host (localhost, IP address, or docker service name)
export DB_HOST="localhost"

# PostgreSQL port
export DB_PORT="5432"

# Database name to backup
export DB_NAME="copilot_main"

# PostgreSQL username
export DB_USER="copilot"

# PostgreSQL password (REQUIRED - set this securely)
# DO NOT commit this file with real password!
export DB_PASSWORD="your_secure_password_here"

# ============================================================
# Optional: Slack Notifications
# ============================================================
# Get webhook URL from: https://api.slack.com/apps

# Enable/disable Slack notifications
export ENABLE_SLACK_NOTIFICATIONS="false"

# Slack incoming webhook URL
export SLACK_WEBHOOK_URL="https://hooks.slack.com/services/YOUR/WEBHOOK/URL"

# ============================================================
# Optional: Advanced Configuration
# ============================================================

# Compression level (1-9, where 9 is maximum compression)
# Default: 6 (good balance between speed and size)
# export GZIP_COMPRESSION_LEVEL="6"

# Maximum parallel uploads (for multiple databases)
# export MAX_PARALLEL_UPLOADS="3"

# Timeout for SSH operations (in seconds)
# export SSH_TIMEOUT="300"

# Enable verbose logging
# export VERBOSE="false"

# ============================================================
# Usage Examples
# ============================================================
#
# 1. Load this configuration:
#    source .env.storagebox
#
# 2. Run manual backup:
#    ./scripts/hetzner-storagebox-backup.sh
#
# 3. Run restore:
#    ./scripts/hetzner-storagebox-restore.sh
#
# 4. Setup automated backups:
#    ./scripts/setup-backup-cron-hetzner.sh
#
# 5. Test SSH connection:
#    ssh -p $STORAGEBOX_PORT -i $STORAGEBOX_SSH_KEY $STORAGEBOX_USER@$STORAGEBOX_HOST
#
# 6. List remote backups:
#    ssh -p $STORAGEBOX_PORT -i $STORAGEBOX_SSH_KEY $STORAGEBOX_USER@$STORAGEBOX_HOST \
#        "ls -lh $STORAGEBOX_REMOTE_DIR"
#
# ============================================================
