# Gitleaks Configuration
# Ignores test fixtures and mock data

title = "Gitleaks Configuration for Cloud Governance Copilot"

[allowlist]
description = "Allowlist for test fixtures and mock credentials"

# Paths to ignore
paths = [
  '''.*__fixtures__/.*''',
  '''.*__tests__/.*''',
  '''.*__mocks__/.*''',
  '''.*/test/.*''',
  '''.*/tests/.*''',
  '''.*\.test\.ts$''',
  '''.*\.spec\.ts$''',
  '''.*\.fixture\.ts$''',
  '''\.env\.example$''',
  '''apps/api-gateway/tests/setup\.ts$''',
  '''apps/frontend/tests/setup\.ts$''',
]

# Regex patterns to allow
[[allowlist.regexes]]
regex = '''AKIAIOSFODNN7EXAMPLE'''
description = "Example AWS Access Key ID in test files"

[[allowlist.regexes]]
regex = '''wJalrXUtnFEMI'''
description = "Example AWS Secret Access Key in test files"

[[allowlist.regexes]]
regex = '''(?i)(password|secret|key|token).*=.*example'''
description = "Example credentials in .env.example files"

[[allowlist.regexes]]
regex = '''test-(jwt-)?secret(-key)?(-for-testing-only)?'''
description = "Test JWT secrets in test setup files"

[[allowlist.regexes]]
regex = '''test-refresh-secret-key-for-testing-only'''
description = "Test refresh token secrets in test setup files"

[[allowlist.regexes]]
regex = '''development-secret-key'''
description = "Development fallback secrets (never used in production)"

[[allowlist.regexes]]
regex = '''JWT_SECRET.*development-secret-key'''
description = "Development JWT secret fallbacks in code"

# Stopwords to prevent false positives on common variable names
[[allowlist.stopwords]]
stopwords = [
  'example',
  'test',
  'development',
  'fallback',
  'default',
  'placeholder',
]
